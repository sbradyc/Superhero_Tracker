<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Superhero Tracker</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
        <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='images/favicon.ico') }}">
    </head>
    <body>
        <h1>{{message}}</h1>
        <nav class="navbar">
            <ul class="nav-links">
                <li><a href="/">Home</a></li>
                <li><a href="/cities">Cities</a></li>
                <li><a href="/countries">Countries</a></li>
                <li><a href="/heroes">Heroes</a></li>
                <li><a href="/villains">Villains</a></li>
                <li><a href="/missions">Missions</a></li>
                <li><a href="/powers">Powers</a></li>
            </ul>
        </nav>
        <h2 class="form-header">Add a New Hero</h2>
        <h3 class="error-message">{{ message }}</h3>
        <form action="/heroes-add" method="post">
            <label for="pseudonym">Pseudonym: </label>
            <input type="text" id="pseudonym" name="pseudonym" required><br>
            <label for="first-name">First Name: </label>
            <input type="text" id="first-name" name="first-name" required><br>
            <label for="last-name">Last Name: </label>
            <input type="text" id="last-name" name="last-name" required><br>
            <label for="city_name">City Name: </label>
            <select id="city_name" name="city_id" required>
                <option value="" disabled selected>Select a city</option>
                {% for city in cities %}
                    <option value="{{ city.city_id }}">{{ city.city_name }}</option>
                {% endfor %}
            </select>
            <!-- This is just an example, the actual implementation would probably look pretty different once actual data is used -->
            <label>Powers:</label>
            <div id="power-select">
                <div id="available-power-list">
                    <h4>Available</h4>
                    <input type="checkbox" id="power-1", name="power-1">
                    <label for="power-1">Super strength</label>
                    <input type="checkbox" id="power-2", name="power-2">
                    <label for="power-2">Super speed</label>
                    <input type="checkbox" id="power-3", name="power-3">
                    <label for="power-3">Super hearing</label>

                </div>
                <div id="chosen-power-list">
                    <h4>Selected</h4>
                </div>
            </div>
            <script>
                const inputs = [...document.getElementById('available-power-list').childNodes].filter(child => child.nodeName === 'INPUT')
                const labels = [...document.getElementById('available-power-list').childNodes].filter(child => child.nodeName === 'LABEL')
                const chosen_power_list = document.getElementById('chosen-power-list')

                // make sure boxes are unchecked (they normally keep their checked state on reload)
                for (input of inputs) input.checked = false

                function updateChosenPower(input, label) {
                    // add power to chosen list if checked, remove it if unchecked
                    if (input.checked) {
                        const added_power = document.createElement('p')

                        added_power.setAttribute('id', `power-${label.textContent}`)
                        added_power.textContent = label.textContent
                        added_power.addEventListener('click', () => {
                            added_power.remove()
                            input.checked = false
                        })

                        chosen_power_list.appendChild(added_power)
                    } else {
                        const removed_power = document.getElementById(`power-${label.textContent}`)

                        removed_power.remove()
                    }
                }

                for (let [index, input] of inputs.entries()) {
                    input.addEventListener('change', () => updateChosenPower(input, labels[index]))
                }
            </script>
            <div class="form-actions">
                <input type="submit" class="submit-button" value="Submit">
                <a href="/heroes" class="cancel-button">Cancel</a>
            </div>
        </form>
    </body>
</html>
